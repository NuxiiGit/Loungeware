name: GMLint
on:
  pull_request:
    branches: [ main ]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Verify Code
        run: |
          RESULT=$(./scripts/gmlint/gmlint)
          mkdir -p output/
          if [ -z "$RESULT" ]; then
            echo "Everything looks good!" > output/results.txt
          else
            echo "RESULT" > output/results.txt
            echo "Your code smells, check the list of errors above for reasons why ^" >> output/results.txt
          fi
      - uses: actions/upload-artifact@v1
        with:
          name: results
          path: output
      - uses: actions/download-artifact@v1
        with:
          name: results
      - name: Comment on PR
        uses: machine-learning-apps/pr-comment@master
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          path: results/results.txt
